enyo.kind({name:"avis.rss",kind:"Component",events:{onSuccess:"",onMetadata:"",onIncrement:"",onLog:""},components:[{name:"shows",url:"data/shows.json",kind:"WebService",onSuccess:"showsSuccess",onFailure:"queryFailure"},{name:"video",kind:"WebService",onSuccess:"videoSuccess",onFailure:"queryFailure"},{name:"audio",kind:"WebService",onSuccess:"audioSuccess",onFailure:"queryFailure"}],create:function(){this.inherited(arguments);this.shows=[];this.detected=0;this.content_length=0;this.maximum=0},getShows:function(){this.$.shows.call()},showsSuccess:function(d,b,a){this.shows=b;this.maximum=this.shows.length*2;this.doMetadata(this.maximum);for(var c=0;c<this.shows.length;c++){this.$.video.setUrl(b[c].video_url);this.$.video.call();this.$.audio.setUrl(b[c].audio_url);this.$.audio.call()}},queryFailure:function(b,a){this.detected++;this.verifyState()},videoSuccess:function(g,c,a){var b=XMLObjectifier.textToXML(c);c=XMLObjectifier.xmlToJSON(b);try{c=c.channel[0].item}catch(f){this.detected++}try{this.identifyShow(c,"video")}catch(d){this.verifyState()}},audioSuccess:function(g,c,a){var b=XMLObjectifier.textToXML(c);c=XMLObjectifier.xmlToJSON(b);try{c=c.channel[0].item}catch(f){this.detected++}try{this.identifyShow(c,"audio")}catch(d){this.verifyState()}},verifyState:function(){this.doIncrement(this.detected);if(this.detected===this.maximum){this.doSuccess(this.shows)}},identifyShow:function(b,f){var d=false;var e=b[0].title[0].Text.match(/[\d\.]+/g);var g=b[0].title[0].Text.split(e[0]);var a=g[0].slice(0,-1);for(var c=0;c<this.shows.length;c++){if(this.shows[c].title===a){switch(f){case"video":this.shows[c].video=b;d=true;this.detected++;break;case"audio":this.shows[c].audio=b;d=true;this.detected++;break}break}}if(!d){this.detected++}this.verifyState()}});